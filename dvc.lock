schema: '2.0'
stages:
  data_cleaning:
    cmd: python src/data_preprocessing.py
    deps:
    - path: data/raw/Dev_data_to_be_shared.csv
      hash: md5
      md5: 604fb57d7d4debda34605cae2c7b4842
      size: 293487740
    - path: data/raw/validation_data_to_be_shared.csv
      hash: md5
      md5: 2afc6f4b619122415e5cf97a4aca907b
      size: 126617929
    - path: src/data_preprocessing.py
      hash: md5
      md5: 19ec080be31869cca3abaecd665c2bb6
      size: 7481
    params:
      params.yaml:
        data_cleaning.DEV_DATA_PATH: data/raw/Dev_data_to_be_shared.csv
        data_cleaning.ENCODING_TECHNIQUE: target
        data_cleaning.IMPUTATION_TECHNIQUE: mode
        data_cleaning.KNN_IMPUTER_N_NEIGHBORS: 5
        data_cleaning.NULL_PERCENTAGE: 0.25
        data_cleaning.RANDOM_STATE: 42
        data_cleaning.TEST_SIZE: 0.2
        data_cleaning.VAL_DATA_PATH: data/raw/validation_data_to_be_shared.csv
        data_cleaning.VARIANCE_THRESHOLD: 0
        experiment.EXPERIMENT_NAME: experiment_2
    outs:
    - path: data/interim/test.csv
      hash: md5
      md5: 8c063eb8daf21935a9352cd120e894c8
      size: 41368218
    - path: data/interim/train.csv
      hash: md5
      md5: da5fd964d34a1bead664c707870aa39e
      size: 165471400
    - path: data/interim/validation.csv
      hash: md5
      md5: a809d799a0c400b1ed82691abec71850
      size: 89275534
  feature_engineering:
    cmd: python src/feature_engineering.py
    deps:
    - path: data/interim/test.csv
      hash: md5
      md5: 8c063eb8daf21935a9352cd120e894c8
      size: 41368218
    - path: data/interim/train.csv
      hash: md5
      md5: da5fd964d34a1bead664c707870aa39e
      size: 165471400
    - path: data/interim/validation.csv
      hash: md5
      md5: a809d799a0c400b1ed82691abec71850
      size: 89275534
    - path: src/feature_engineering.py
      hash: md5
      md5: 61e639ded27cd3076a0788681bedefad
      size: 12598
    params:
      params.yaml:
        experiment.EXPERIMENT_NAME: experiment_2
        feature_engineering.ANOVA_K: 40
        feature_engineering.FEATURE_IMPORTANCE_TECHNIQUE: anova
        feature_engineering.FEATURE_SELECTION_TECHNIQUE: skip
        feature_engineering.MAX_DEPTH: 10
        feature_engineering.MAX_FEATURES: sqrt
        feature_engineering.MIN_SAMPLES_LEAF: 2
        feature_engineering.MIN_SAMPLES_SPLIT: 5
        feature_engineering.NO_FEATURES: 40
        feature_engineering.N_ESTIMATORS: 200
        feature_engineering.RANDOM_STATE: 42
        feature_engineering.SFS_FORWARD: false
    outs:
    - path: data/processed/test.csv
      hash: md5
      md5: 8c063eb8daf21935a9352cd120e894c8
      size: 41368218
    - path: data/processed/train.csv
      hash: md5
      md5: da5fd964d34a1bead664c707870aa39e
      size: 165471400
    - path: data/processed/val.csv
      hash: md5
      md5: a809d799a0c400b1ed82691abec71850
      size: 89275534
  model_training:
    cmd: python src/Model_Building.py
    deps:
    - path: data/processed/test.csv
      hash: md5
      md5: 8c063eb8daf21935a9352cd120e894c8
      size: 41368218
    - path: data/processed/train.csv
      hash: md5
      md5: da5fd964d34a1bead664c707870aa39e
      size: 165471400
    - path: data/processed/val.csv
      hash: md5
      md5: a809d799a0c400b1ed82691abec71850
      size: 89275534
    - path: src/Model_Building.py
      hash: md5
      md5: 00ee1a02001347df832db77a947d1f06
      size: 18647
    params:
      params.yaml:
        experiment.EXPERIMENT_NAME: experiment_2
        model_training.ALPHA:
        - 0
        - 10
        model_training.BATCH_SIZE: 128
        model_training.COL_SAMPLE_BY_TREE:
        - 0.5
        - 1.0
        model_training.DEVICE: cuda
        model_training.DROPOUT_RATE: 0.3
        model_training.ETA:
        - 0.005
        - 0.3
        model_training.EVAL_METRIC: logloss
        model_training.GAMMA: 0.1
        model_training.GAMMA_XGB:
        - 0
        - 5
        model_training.HIDDEN_DIMS:
        - 1024
        - 512
        - 256
        - 256
        - 128
        - 64
        - 64
        - 32
        - 32
        - 16
        model_training.LAMBDA:
        - 0
        - 10
        model_training.LEARNING_RATE: 0.001
        model_training.MAX_DEPTH:
        - 3
        - 15
        model_training.MIN_CHILD_WEIGHT:
        - 1
        - 20
        model_training.MODEL: mlp
        model_training.NO_LAYERS: 10
        model_training.N_EPOCHS: 100
        model_training.N_ESTIMATORS:
        - 50
        - 500
        model_training.N_TRIALS: 10
        model_training.OBJECTIVE: binary:logistic
        model_training.PATIENCE: 10
        model_training.SCALE_POS_WEIGHT:
        - 1
        - 10
        model_training.SEED: 42
        model_training.STEP_SIZE: 10
        model_training.SUB_SAMPLE:
        - 0.5
        - 1.0
        model_training.TIMEOUT: 600
        model_training.TREE_METHOD: hist
        model_training.VAL_THRESHOLD: 0.1
        model_training.WEIGHT_DECAY: 1e-05
  prediction:
    cmd: python src/prediction.py
    deps:
    - path: data/processed/val.csv
      hash: md5
      md5: a809d799a0c400b1ed82691abec71850
      size: 89275534
    - path: src/prediction.py
      hash: md5
      md5: 9d36552d8172c9469e22d57d3f94e602
      size: 4008
    params:
      params.yaml:
        experiment.EXPERIMENT_NAME: experiment_2
        prediction.DATA: data/processed/val.csv
        prediction.MLP_MODEL_PATH: models/mlp_model.pth
        prediction.MODEL: mlp
        prediction.SUBMISSION_FILE_PATH: prediction.csv
        prediction.XGB_MODEL_PATH: models/xgboost_model.pkl
    outs:
    - path: prediction.csv
      hash: md5
      md5: 771593182d1891dc55850e5778a772ef
      size: 922535
